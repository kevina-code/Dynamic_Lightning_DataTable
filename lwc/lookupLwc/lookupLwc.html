<template>
  <div class="lookup-container">
    <div>
      <div class="slds-form-element">
        <div class="slds-form-element__control">
          <div class="slds-combobox_container">
            <div
              id="box"
              class={boxClass}
              aria-expanded="true"
              aria-haspopup="listbox"
              role="combobox"
            >
              <div
                class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon_right"
                role="none"
              >
                <template lwc:if={readOnly}>
                  <div class="disabled-overlay"></div>
                </template>
                <template lwc:if={isValue}>
                  <div id="lookup-pill" class="slds-pill-container">
                    <template lwc:if={makeColumnsReadOnly}>
                      <p style="border: 1px solid black">
                        <lightning-formatted-text value={label}
                          ><lightning-icon
                            icon-name={iconName}
                            alternative-text={objLabelName}
                          >
                          </lightning-icon
                        ></lightning-formatted-text>
                      </p>
                    </template>
                    <template lwc:else>
                      <lightning-pill
                        class="pillSize"
                        label={label}
                        name={label}
                        onremove={handleRemovePill}
                        href={href}
                        disabled={makeColumnsReadOnly}
                      >
                        <lightning-icon
                          icon-name={iconName}
                          alternative-text="objLabelName"
                        >
                        </lightning-icon>
                      </lightning-pill>
                    </template>
                  </div>
                </template>
                <template if:false={isValue}>
                  <div class="slds-p-top_none">
                    <lightning-input
                      class={inputClass}
                      type="search"
                      id="input"
                      value={searchTerm}
                      onclick={handleClick}
                      onchange={onChange}
                      variant="label-hidden"
                      autocomplete="off"
                      placeholder={placeholder}
                      disabled={makeColumnsReadOnly}
                    >
                    </lightning-input>
                  </div>
                </template>
              </div>
              <template lwc:if={options}>
                <div
                  id="listbox-id-11"
                  class="slds-dropdown slds-dropdown_length-with-icon-7 slds-dropdown_fluid"
                  role="listbox"
                >
                  <ul
                    class="slds-listbox slds-listbox_vertical"
                    role="presentation"
                  >
                    <template for:each={options} for:item="item">
                      <li
                        key={item.Id}
                        onclick={handleSelect}
                        data-id={item.Id}
                        role="presentation"
                      >
                        <span
                          class="slds-lookup__item-action slds-lookup__item-action--label"
                          role="option"
                        >
                          <lightning-icon
                            class="slds-icon slds-icon--small slds-icon-text-default"
                            icon-name={iconName}
                            alternative-text={objName}
                            size="small"
                          >
                          </lightning-icon>
                          <span class="slds-truncate">{item.label}</span>
                        </span>
                      </li>
                    </template>
                  </ul>
                </div>
              </template>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>